% !TEX root =  main.tex
We had to solve the same problem for functional programming two weeks ago. The solution we used there is easier to understand than bit shifting is to us so we present that solution in the code below. The solution to $33789^{13458} \% 99839 = 0$.
\lstinputlisting[caption=\lstname,label={code:cryptomathh}]{cryptomath.h}
\lstinputlisting[caption=\lstname,label={code:cryptomathc}]{cryptomath.c}
\lstinputlisting[caption=\lstname,label={code:expmod}]{expmod.c}
where the arguments represent the formula $a^e \% n$.